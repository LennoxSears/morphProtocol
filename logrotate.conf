# morphProtocol Log Rotation Configuration
#
# Installation:
#   sudo cp logrotate.conf /etc/logrotate.d/morphprotocol
#   sudo chmod 644 /etc/logrotate.d/morphprotocol
#
# Test:
#   sudo logrotate -d /etc/logrotate.d/morphprotocol
#
# Force rotation:
#   sudo logrotate -f /etc/logrotate.d/morphprotocol

# Server log rotation
/var/log/morphprotocol/server.log {
    # Rotate daily
    daily
    
    # Keep 7 days of logs
    rotate 7
    
    # Rotate if file exceeds 50MB (even if not daily)
    size 50M
    
    # Compress old logs
    compress
    
    # Delay compression until next rotation (keeps most recent backup uncompressed)
    delaycompress
    
    # Don't error if log file is missing
    missingok
    
    # Don't rotate if log is empty
    notifempty
    
    # Create new log file with these permissions
    create 0644 root root
    
    # Use copytruncate instead of moving file (safer for running processes)
    copytruncate
    
    # Run after rotation (optional - for notifications)
    postrotate
        # Uncomment to send notification
        # echo "morphProtocol logs rotated" | mail -s "Log Rotation" admin@example.com
    endscript
}

# Alternative: Rotate by user home directory
# Uncomment if running as non-root user
# /home/*/morphprotocol-server.log {
#     daily
#     rotate 7
#     size 50M
#     compress
#     delaycompress
#     missingok
#     notifempty
#     copytruncate
# }

# Alternative: Rotate in current directory
# /root/morphprotocol-server-linux.log {
#     daily
#     rotate 7
#     size 50M
#     compress
#     delaycompress
#     missingok
#     notifempty
#     copytruncate
# }
